function f=hx_dot(xx)
q0=xx(1);q1=xx(2);q2=xx(3);q3=xx(4);
A1=[2*q1*(1-2*(q1^2+q2^2))/((1-2*(q1^2+q2^2))^2+4*(q2*q3+q0*q1)^2);
    2*q2/(sqrt(1-4*(q1*q3-q0*q2)^2));
    2*q3*(1-2*(q3^2+q2^2))/((1-2*(q3^2+q2^2))^2+4*(q2*q1+q0*q3)^2)];
A2=[2*q0*(1-2*(q1^2+q2^2)+4*q1*(q2*q3+q0*q1))/((1-2*(q1^2+q2^2))^2+4*(q2*q3+q0*q1)^2);
    -2*q3/(sqrt(1-4*(q1*q3-q0*q2)^2));
    2*q2*(1-2*(q3^2+q2^2))/((1-2*(q3^2+q2^2))^2+4*(q2*q1+q0*q3)^2)];
A3=[2*q3*(1-2*(q1^2+q2^2)+4*q2*(q2*q3+q0*q1))/((1-2*(q1^2+q2^2))^2+4*(q2*q3+q0*q1)^2);
    2*q0/(sqrt(1-4*(q1*q3-q0*q2)^2));
    (2*q1*(1-2*(q3^2+q2^2))+4*q2*(q1*q2+q0*q3))/((1-2*(q3^2+q2^2))^2+4*(q2*q1+q0*q3)^2)];
A4=[2*q2*(1-2*(q1^2+q2^2))/((1-2*(q1^2+q2^2))^2+4*(q2*q3+q0*q1)^2);
    -2*q1/(sqrt(1-4*(q1*q3-q0*q2)^2));
    (2*q0*(1-2*(q3^2+q2^2))+4*q3*(q0*q3+q1*q2))/((1-2*(q3^2+q2^2))^2+4*(q2*q1+q0*q3)^2)];

f=[A1,A2,A3,A4];

% f=[A5,A1,A2,A3,A4,zeros(3,1)];
    