function f=fx_dot(xx,p,q,r)
q0=xx(7);q1=xx(8);q2=xx(9);q3=xx(10);u=xx(4);v=xx(5);w=xx(6);g=xx(11);
A1=[0,-2*q3,2*q2;2*q3,0,-2*q1;-2*q2,2*q1,0]*[u;v;w];
A2=-1*[-2*q2;2*q1;0]*g;
A3=0.5*[0;p;q;r];
f1=[A1;A2;A3;0];
A4=[0,2*q2,2*q3;2*q2,-4*q1,-2*q0;2*q3,2*q0,-4*q1]*[u;v;w];
A5=-1*[2*q3;2*q0;-4*q1]*g;
A6=0.5*[-1*p;0;-1*r;q];
f2=[A4;A5;A6;0];
A7=[-4*q2,2*q1,2*q0;2*q1,0,2*q3;-2*q0,2*q3,-4*q2]*[u;v;w];
A8=-1*[-2*q0;2*q3;-4*q2]*g;
A9=0.5*[-1*q;r;0;-1*p];
f3=[A7;A8;A9;0];
A10=[-4*q3,-2*q0,2*q1;2*q0,-4*q3,2*q2;2*q1,2*q2,0]*[u;v;w];
A11=-1*[2*q1;2*q2;0]*g;
A12=0.5*[-1*r;-1*q;p;0];
f4=[A10;A11;A12;0];
f5=zeros(11,3);
A13=[1-2*(q2^2+q3^2),2*(q1*q2-q0*q3),2*(q1*q3+q0*q2);
    2*(q1*q2+q0*q3),1-2*(q1^2+q3^2),2*(q2*q3-q0*q1);
    2*(q1*q3-q0*q2),2*(q2*q3+q0*q1),1-2*(q1^2+q2^2);];
A14=-1*[0,-r,q;r,0,-p;-q,p,0];
A15=zeros(5,3);
f6=[A13;A14;A15];
A16=zeros(3,1);
A17=-1*[2*(q1*q3-q0*q2);2*(q2*q3+q0*q1);1-2*(q1^2+q2^2)];
A18=zeros(5,1);
f7=[A16;A17;A18];
% f7=zeros(11,1);
f=[f5,f6,f1,f2,f3,f4,f7];
